# å•å…ƒæµ‹è¯•

## å‰è¨€

### å‰ç«¯å•æµ‹æ˜¯ä¸€ä¸ªå¯æœ‰å¯æ— çš„ä¸œè¥¿ï¼Ÿ

+ å†™å•æµ‹æ¯”è¾ƒè´¹æ—¶ï¼Œæœ‰è¿™ä¸ªæ—¶é—´ä¸å¦‚å¤šåšå‡ ä¸ªéœ€æ±‚ï¼
+ æµ‹è¯•åœ¨éªŒæ”¶çš„æ—¶å€™å¯¹é¡µé¢çš„åŠŸèƒ½éƒ½ä¼šæ“ä½œä¸€éï¼Œå†™å•æµ‹ç›¸å½“äºæ— ç”¨åŠŸ
+ åç«¯æä¾›ç»™å‰ç«¯çš„æ¥å£éœ€è¦ä¿è¯è´¨é‡ï¼Œå› æ­¤éœ€è¦åšå•æµ‹ï¼Œä½†å‰ç«¯å¾ˆå°‘éœ€è¦æä¾›æ¥å£ç»™å…¶ä»–äººã€‚

### ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å•æµ‹

åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¦‚æœå…¬å¸ä¸šåŠ¡ä¸å¤æ‚ï¼Œæˆ‘æ˜¯è®¤åŒå®Œå…¨æ²¡æœ‰å¿…è¦åšå•æµ‹çš„è§‚ç‚¹çš„ã€‚ä½†å¦‚æœæ¶‰åŠåˆ°äº†ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼Œåˆ™è¦å¥½å¥½è€ƒè™‘ä¸€ä¸‹ï¼š

+ ä¸šåŠ¡æ¯”è¾ƒå¤æ‚ï¼Œå‰ç«¯å‚ä¸çš„äººå‘˜è¶…è¿‡3äºº
+ å…¬å¸éå¸¸æ³¨é‡ä»£ç çš„è´¨é‡ï¼Œæƒ³å°½ä¸€åˆ‡åŠæ³•æœç»çº¿ä¸Šå‡ºbug
+ æ˜¯è·¨é¡¹ç›®ç»„ä»¶çš„æä¾›æ–¹
+ åœ¨åšä¸€ä¸ªå¼€æºé¡¹ç›®

### ç»„ä»¶åŒ–å•æµ‹çš„å¿…è¦æ€§ï¼š

+ è™½ç„¶å•å…ƒæµ‹è¯•éœ€è¦èŠ±è´¹æ—¶é—´ä¸”æ‰€èŠ±æ—¶é—´ä¼šæ¯”æ¨¡å—æœ¬èº«æ›´å¤šï¼Œä½†æ˜¯æ€§ä»·æ¯”å´æ˜¯éšç€ä½¿ç”¨çš„æ¬¡æ•°è¶Šæ¥è¶Šé«˜
+ åœ¨å·¥ä½œä¸­æˆ–å¼€æºç¤¾åŒºä¸­ï¼Œæˆ‘ä»¬å†™åº“çš„ç›®çš„éƒ½æ˜¯ä¸ºäº†èƒ½æ›´å¥½çš„ä¸ºåˆ«äººä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™å•å…ƒæµ‹è¯•åº”è¯¥æ˜¯å¿…é¡»çš„
+ å¥½çš„å•å…ƒæµ‹è¯•å¯ä»¥ä½œä¸ºä¼˜ç§€çš„æ–‡æ¡£ï¼Œå¹¶ä¸”ä¿è¯æ¨¡å—è¡Œä¸ºçš„ç¡®å®šæ€§ã€‚
+ UIåº“å¹¶ä¸æ¶‰åŠä¸šåŠ¡é€»è¾‘ï¼Œæ‰€ä»¥åªå†™å•å…ƒæµ‹è¯•è¶³å¤Ÿ

### æµ‹å“ªäº›æ–¹é¢

+ æ¨¡å—åº”è¢«æ¸²æŸ“çš„DOMæ ‘æ˜¯å¦æ­£ç¡®
+ æ¨¡å—çš„å±æ€§ä¼ é€’æ˜¯å¦æ­£ç¡®,(å±æ€§æ˜¯æ–¹æ³•,åˆ™æ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨;å±æ€§æ˜¯å¸ƒå°”å€¼æˆ–å¯¹è±¡,åˆ™æ˜¯å¦è¢«æ­£ç¡®ä¼ é€’ä¸”è¾¾åˆ°é¢„æœŸçš„ç›®çš„ï¼‰
+ æ¨¡å—å†…çš„å„ä¸ªè¡Œä¸ºæ˜¯å¦æ­£ç¡®
+ ç”šè‡³å¯ä»¥æµ‹è¯•å„ä¸ªDOMèŠ‚ç‚¹æ˜¯å¦è¢«åº”ç”¨é¢„æœŸçš„classï¼Œä¸”è¿™äº›classæ˜¯ä¸æ˜¯é¢„æœŸçš„æ ·å¼

## æµ‹è¯•å·¥å…·

+ [Jest](https://facebook.github.io/jest/docs/en/getting-started.html)æ˜¯Facebookå¼€å‘çš„ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œå®ƒé›†æˆäº†æµ‹è¯•æ‰§è¡Œå™¨ã€æ–­è¨€åº“ã€spyã€mockã€snapshotå’Œæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šç­‰åŠŸèƒ½ã€‚Reacté¡¹ç›®æœ¬èº«ä¹Ÿæ˜¯ä½¿ç”¨Jestè¿›è¡Œå•æµ‹çš„ï¼Œå› æ­¤å®ƒä»¬ä¿©çš„å¥‘åˆåº¦ç›¸å½“é«˜ã€‚
+ [Enzyme](http://airbnb.io/enzyme/)æ˜¯ç”±airbnbå¼€å‘çš„Reactå•æµ‹å·¥å…·ã€‚å®ƒæ‰©å±•äº†Reactçš„TestUtilså¹¶é€šè¿‡æ”¯æŒç±»ä¼¼jQueryçš„findè¯­æ³•å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¹renderå‡ºæ¥çš„ç»“æœåšå„ç§æ–­è¨€ã€‚

## JEST è·‘ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹

> æŠ€æœ¯æ ˆï¼šReact@16 + webpack@3

> ç¼–å†™æµ‹è¯•ç”¨ä¾‹æµç¨‹ï¼š
+ Arrangeï¼ˆå‡†å¤‡ï¼‰ï¼šè®¾ç½®æµ‹è¯•åœºæ™¯ï¼Œå‡†å¤‡æµ‹è¯•æ•°æ®
+ Actï¼ˆæ‰§è¡Œï¼‰ï¼šè°ƒç”¨è¢«æµ‹è¯•ä»£ç 
+ Assertï¼ˆæ–­è¨€ï¼‰ï¼šéªŒè¯è¢«æµ‹ä»£ç æ˜¯å¦ä¸é¢„æœŸç›¸åŒ

### å®‰è£…Jestå¹¶è®©å…¶æ”¯æŒES6è¯­æ³•

```bash
npm install --save-dev jest jest-cli babel-jest # babel-jestçš„ä½œç”¨æ˜¯è®©å•æµ‹ä»£ç æ”¯æŒES6
```

### æ–°å»ºå•æµ‹æ–‡ä»¶å¤¹å¹¶æ–°å»ºä¸€ä¸ªå•æµ‹æ–‡ä»¶

1.åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»º`__jest__`æ–‡ä»¶å¤¹å’Œ`components`æ–‡ä»¶å¤¹

+ \_\_jest__
    + \_\_mocks__
    + \_\_tests__
        + mudules // å­˜æ”¾å„ä¸ªæ¨¡å—çš„å•æµ‹ä»£ç 
        + utils // å¯¹ä¸€äº›å…¬ç”¨å‡½æ•°å†™çš„æµ‹è¯•ä»£ç 
            + sum.test.js // å•æµ‹ç”¨ä¾‹
+ components
    + Math.js // è¢«æµ‹è¯•å¯¹è±¡

2.æ–°å»ºå•æµ‹æ–‡ä»¶

```javascript
// __jest__/__test__/sum.test.js
const sum = require('../../../components/Math');

test('adds 1 + 2 to equal 3', () => {
  expect(sum(1, 2)).toBe(3);
});
```

```javascript
function sum(a, b) {
  return a + b;
}
module.exports = sum;

```

### é…ç½®package.json

```json
"jest": {
    // moduleFileExtensionså¯¹åº”webpackä¸­çš„extensionsï¼›
    "moduleFileExtensions": [
      "js",
      "jsx"
    ],
    // moduleDirectorieså¯¹åº”webpackä¸­çš„modulesDirectoriesï¼›
    "moduleDirectories": [
      "node_modules"
    ],
    // moduleNameMapperå¯¹åº”webpackä¸­çš„alias
    "moduleNameMapper": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "<rootDir>/__jest__/__mocks__/fileMock.js",
      "\\.(css|scss)$": "identity-obj-proxy", // å¯¹äºcssç­‰æ ·å¼æ–‡ä»¶ï¼Œä½¿ç”¨identity-obj-proxyæ¥mockï¼Œå®ƒä¼šåœ¨å¼•ç”¨åˆ°classçš„åœ°æ–¹ç›´æ¥è¿”å›classçš„ç±»å
      "^cpn(.*)$": "<rootDir>/src/components$1" //è¿™é‡Œçš„<rootDir>å¯¹åº”æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ã€‚
    }
  }
```

åŒæ—¶æ·»åŠ ä»¥ä¸‹scriptï¼š

```json
  "scripts": {
    "test": "jest __jest__/__tests__"
  }
```

### è¿è¡Œæµ‹è¯•è„šæœ¬

åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š`npm run test`
å‡ºç°ä»¥ä¸‹ç»“æœï¼Œåˆ™è¯´æ˜Jestå®‰è£…æˆåŠŸå¹¶é€šè¿‡ç¬¬ä¸€ä¸ªæµ‹è¯•!ğŸ‘
![jest_result](./assets/jest_result.png)
